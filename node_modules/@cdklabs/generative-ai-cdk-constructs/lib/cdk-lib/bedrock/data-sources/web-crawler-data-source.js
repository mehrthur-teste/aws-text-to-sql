"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.WebCrawlerDataSource = exports.CrawlingScope = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_bedrock_1 = require("aws-cdk-lib/aws-bedrock");
const base_data_source_1 = require("./base-data-source");
const utils_1 = require("../../../common/helpers/utils");
/**
 * The scope of the crawling.
 */
var CrawlingScope;
(function (CrawlingScope) {
    /**
     * Crawls only web pages that belong to the same host or primary domain.
     */
    CrawlingScope["HOST_ONLY"] = "HOST_ONLY";
    /**
     * Includes subdomains in addition to the host or primary domain, i.e.
     * web pages that contain "aws.amazon.com" can also include
     * sub domain "docs.aws.amazon.com"
     */
    CrawlingScope["SUBDOMAINS"] = "SUBDOMAINS";
    /**
     * Limit crawling to web pages that belong to the same host and with the
     * same initial URL path.
     */
    CrawlingScope["DEFAULT"] = "DEFAULT";
})(CrawlingScope || (exports.CrawlingScope = CrawlingScope = {}));
/**
 * Sets up a web crawler data source to be added to a knowledge base.
 */
class WebCrawlerDataSource extends base_data_source_1.DataSourceNew {
    constructor(scope, id, props) {
        super(scope, id);
        // Assign attributes
        this.knowledgeBase = props.knowledgeBase;
        this.dataSourceType = base_data_source_1.DataSourceType.WEB_CRAWLER;
        this.dataSourceName =
            props.dataSourceName ??
                (0, utils_1.generatePhysicalNameV2)(this, 'crawler-ds', { maxLength: 40, lower: true, separator: '-' });
        this.kmsKey = props.kmsKey;
        this.crawlingRate = props.crawlingRate ?? 300;
        this.siteUrls = props.sourceUrls;
        // ------------------------------------------------------
        // Manage permissions for the data source
        // ------------------------------------------------------
        this.handleCommonPermissions(props);
        // ------------------------------------------------------
        // L1 Instantiation
        // ------------------------------------------------------
        this.__resource = new aws_bedrock_1.CfnDataSource(this, 'DataSource', {
            ...this.formatAsCfnProps(props, {
                type: this.dataSourceType,
                webConfiguration: {
                    crawlerConfiguration: {
                        crawlerLimits: {
                            rateLimit: this.crawlingRate,
                        },
                        scope: props.crawlingScope !== CrawlingScope.DEFAULT ? props.crawlingScope : undefined, //?? CrawlingScope.HOST_ONLY,
                        inclusionFilters: props.filters?.includePatterns,
                        exclusionFilters: props.filters?.excludePatterns,
                    },
                    sourceConfiguration: {
                        urlConfiguration: {
                            seedUrls: props.sourceUrls.map(item => ({ url: item })),
                        },
                    },
                },
            }),
        });
        this.dataSourceId = this.__resource.attrDataSourceId;
    }
}
exports.WebCrawlerDataSource = WebCrawlerDataSource;
_a = JSII_RTTI_SYMBOL_1;
WebCrawlerDataSource[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.bedrock.WebCrawlerDataSource", version: "0.1.293" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViLWNyYXdsZXItZGF0YS1zb3VyY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY2RrLWxpYi9iZWRyb2NrL2RhdGEtc291cmNlcy93ZWItY3Jhd2xlci1kYXRhLXNvdXJjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBRUgseURBQXdEO0FBS3hELHlEQUErRjtBQUMvRix5REFBdUU7QUFFdkU7O0dBRUc7QUFDSCxJQUFZLGFBZ0JYO0FBaEJELFdBQVksYUFBYTtJQUN2Qjs7T0FFRztJQUNILHdDQUF1QixDQUFBO0lBQ3ZCOzs7O09BSUc7SUFDSCwwQ0FBeUIsQ0FBQTtJQUN6Qjs7O09BR0c7SUFDSCxvQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBaEJXLGFBQWEsNkJBQWIsYUFBYSxRQWdCeEI7QUF1REQ7O0dBRUc7QUFDSCxNQUFhLG9CQUFxQixTQUFRLGdDQUFhO0lBNENyRCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQWdDO1FBQ3hFLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDakIsb0JBQW9CO1FBQ3BCLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQztRQUN6QyxJQUFJLENBQUMsY0FBYyxHQUFHLGlDQUFjLENBQUMsV0FBVyxDQUFDO1FBQ2pELElBQUksQ0FBQyxjQUFjO1lBQ2pCLEtBQUssQ0FBQyxjQUFjO2dCQUNwQixJQUFBLDhCQUFzQixFQUFDLElBQUksRUFBRSxZQUFZLEVBQUUsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDN0YsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO1FBQzNCLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDLFlBQVksSUFBSSxHQUFHLENBQUM7UUFDOUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDO1FBRWpDLHlEQUF5RDtRQUN6RCx5Q0FBeUM7UUFDekMseURBQXlEO1FBQ3pELElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVwQyx5REFBeUQ7UUFDekQsbUJBQW1CO1FBQ25CLHlEQUF5RDtRQUV6RCxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksMkJBQWEsQ0FBQyxJQUFJLEVBQUUsWUFBWSxFQUFFO1lBQ3RELEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssRUFBRTtnQkFDOUIsSUFBSSxFQUFFLElBQUksQ0FBQyxjQUFjO2dCQUN6QixnQkFBZ0IsRUFBRTtvQkFDaEIsb0JBQW9CLEVBQUU7d0JBQ3BCLGFBQWEsRUFBRTs0QkFDYixTQUFTLEVBQUUsSUFBSSxDQUFDLFlBQVk7eUJBQzdCO3dCQUNELEtBQUssRUFBRSxLQUFLLENBQUMsYUFBYSxLQUFLLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSw2QkFBNkI7d0JBQ3JILGdCQUFnQixFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUUsZUFBZTt3QkFDaEQsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFBRSxlQUFlO3FCQUNqRDtvQkFDRCxtQkFBbUIsRUFBRTt3QkFDbkIsZ0JBQWdCLEVBQUU7NEJBQ2hCLFFBQVEsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQzt5QkFDeEQ7cUJBQ0Y7aUJBQ0Y7YUFDRixDQUFDO1NBQ0gsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDO0lBQ3ZELENBQUM7O0FBdkZILG9EQXdGQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogIENvcHlyaWdodCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiAgd2l0aCB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqICBvciBpbiB0aGUgJ2xpY2Vuc2UnIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICdBUyBJUycgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFU1xuICogIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiAgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENmbkRhdGFTb3VyY2UgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYmVkcm9jayc7XG5pbXBvcnQgeyBJS2V5IH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWttcyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcblxuaW1wb3J0IHsgSUtub3dsZWRnZUJhc2UgfSBmcm9tICcuLy4uL2tub3dsZWRnZS1iYXNlcy9rbm93bGVkZ2UtYmFzZSc7XG5pbXBvcnQgeyBEYXRhU291cmNlTmV3LCBEYXRhU291cmNlQXNzb2NpYXRpb25Qcm9wcywgRGF0YVNvdXJjZVR5cGUgfSBmcm9tICcuL2Jhc2UtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHsgZ2VuZXJhdGVQaHlzaWNhbE5hbWVWMiB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9oZWxwZXJzL3V0aWxzJztcblxuLyoqXG4gKiBUaGUgc2NvcGUgb2YgdGhlIGNyYXdsaW5nLlxuICovXG5leHBvcnQgZW51bSBDcmF3bGluZ1Njb3BlIHtcbiAgLyoqXG4gICAqIENyYXdscyBvbmx5IHdlYiBwYWdlcyB0aGF0IGJlbG9uZyB0byB0aGUgc2FtZSBob3N0IG9yIHByaW1hcnkgZG9tYWluLlxuICAgKi9cbiAgSE9TVF9PTkxZID0gJ0hPU1RfT05MWScsXG4gIC8qKlxuICAgKiBJbmNsdWRlcyBzdWJkb21haW5zIGluIGFkZGl0aW9uIHRvIHRoZSBob3N0IG9yIHByaW1hcnkgZG9tYWluLCBpLmUuXG4gICAqIHdlYiBwYWdlcyB0aGF0IGNvbnRhaW4gXCJhd3MuYW1hem9uLmNvbVwiIGNhbiBhbHNvIGluY2x1ZGVcbiAgICogc3ViIGRvbWFpbiBcImRvY3MuYXdzLmFtYXpvbi5jb21cIlxuICAgKi9cbiAgU1VCRE9NQUlOUyA9ICdTVUJET01BSU5TJyxcbiAgLyoqXG4gICAqIExpbWl0IGNyYXdsaW5nIHRvIHdlYiBwYWdlcyB0aGF0IGJlbG9uZyB0byB0aGUgc2FtZSBob3N0IGFuZCB3aXRoIHRoZVxuICAgKiBzYW1lIGluaXRpYWwgVVJMIHBhdGguXG4gICAqL1xuICBERUZBVUxUID0gJ0RFRkFVTFQnLFxufVxuXG4vKipcbiAqIFRoZSBmaWx0ZXJzIChyZWd1bGFyIGV4cHJlc3Npb24gcGF0dGVybnMpIHRvIGluY2x1ZGUgb3IgZXhjbHVkZSBpbiB0aGUgY3Jhd2xpbmdcbiAqIGluIGFjY29yZGFuY2Ugd2l0aCB5b3VyIHNjb3BlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIENyYXdsaW5nRmlsdGVycyB7XG4gIC8qKlxuICAgKiBJbmNsdWRlIHBhdHRlcm5zLlxuICAgKi9cbiAgcmVhZG9ubHkgaW5jbHVkZVBhdHRlcm5zPzogc3RyaW5nW107XG4gIC8qKlxuICAgKiBFeGNsdWRlIHBhdGhzLlxuICAgKi9cbiAgcmVhZG9ubHkgZXhjbHVkZVBhdHRlcm5zPzogc3RyaW5nW107XG59XG5cbi8qKlxuICogSW50ZXJmYWNlIHRvIGFkZCBhIG5ldyBkYXRhIHNvdXJjZSB0byBhbiBleGlzdGluZyBLQi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXZWJDcmF3bGVyRGF0YVNvdXJjZUFzc29jaWF0aW9uUHJvcHMgZXh0ZW5kcyBEYXRhU291cmNlQXNzb2NpYXRpb25Qcm9wcyB7XG4gIC8qKlxuICAgKiBUaGUgc291cmNlIHVybHMgaW4gdGhlIGZvcm1hdCBgaHR0cHM6Ly93d3cuc2l0ZW5hbWUuY29tYC5cbiAgICogTWF4aW11bSBvZiAxMDAgVVJMcy5cbiAgICovXG4gIHJlYWRvbmx5IHNvdXJjZVVybHM6IHN0cmluZ1tdO1xuICAvKipcbiAgICogVGhlIHNjb3BlIG9mIHRoZSBjcmF3bGluZy5cbiAgICogQGRlZmF1bHQgLSBDcmF3bGluZ1Njb3BlLkRFRkFVTFRcbiAgICovXG4gIHJlYWRvbmx5IGNyYXdsaW5nU2NvcGU/OiBDcmF3bGluZ1Njb3BlO1xuICAvKipcbiAgICogVGhlIG1heCByYXRlIGF0IHdoaWNoIHBhZ2VzIGFyZSBjcmF3bGVkLCB1cCB0byAzMDAgcGVyIG1pbnV0ZSBwZXIgaG9zdC5cbiAgICogSGlnaGVyIHZhbHVlcyB3aWxsIGRlY3JlYXNlIHN5bmMgdGltZSBidXQgaW5jcmVhc2UgdGhlIGxvYWQgb24gdGhlIGhvc3QuXG4gICAqIEBkZWZhdWx0IDMwMFxuICAgKi9cbiAgcmVhZG9ubHkgY3Jhd2xpbmdSYXRlPzogbnVtYmVyO1xuICAvKipcbiAgICogVGhlIGZpbHRlcnMgKHJlZ3VsYXIgZXhwcmVzc2lvbiBwYXR0ZXJucykgZm9yIHRoZSBjcmF3bGluZy5cbiAgICogSWYgdGhlcmUncyBhIGNvbmZsaWN0LCB0aGUgZXhjbHVkZSBwYXR0ZXJuIHRha2VzIHByZWNlZGVuY2UuXG4gICAqIEBkZWZhdWx0IE5vbmVcbiAgICovXG4gIHJlYWRvbmx5IGZpbHRlcnM/OiBDcmF3bGluZ0ZpbHRlcnM7XG59XG5cbi8qKlxuICogSW50ZXJmYWNlIHRvIGNyZWF0ZSBhIG5ldyBzdGFuZGFsb25lIGRhdGEgc291cmNlIG9iamVjdC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXZWJDcmF3bGVyRGF0YVNvdXJjZVByb3BzIGV4dGVuZHMgV2ViQ3Jhd2xlckRhdGFTb3VyY2VBc3NvY2lhdGlvblByb3BzIHtcbiAgLyoqXG4gICAqIFRoZSBrbm93bGVkZ2UgYmFzZSB0byBhc3NvY2lhdGUgd2l0aCB0aGUgZGF0YSBzb3VyY2UuXG4gICAqL1xuICByZWFkb25seSBrbm93bGVkZ2VCYXNlOiBJS25vd2xlZGdlQmFzZTtcbn1cblxuLyoqXG4gKiBTZXRzIHVwIGEgd2ViIGNyYXdsZXIgZGF0YSBzb3VyY2UgdG8gYmUgYWRkZWQgdG8gYSBrbm93bGVkZ2UgYmFzZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFdlYkNyYXdsZXJEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZU5ldyB7XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBDb21tb24gYXR0cmlidXRlcyBmb3IgYWxsIG5ldyBkYXRhIHNvdXJjZXNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGRhdGEgc291cmNlLlxuICAgKiBAZXhhbXBsZSAnSkhVRVZYVVpNVSdcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkYXRhU291cmNlSWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB0eXBlIG9mIGRhdGEgc291cmNlLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGRhdGFTb3VyY2VUeXBlOiBEYXRhU291cmNlVHlwZTtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkYXRhU291cmNlTmFtZTogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIGtub3dsZWRnZSBiYXNlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkga25vd2xlZGdlQmFzZTogSUtub3dsZWRnZUJhc2U7XG4gIC8qKlxuICAgKiBUaGUgS01TIGtleSB0byB1c2UgdG8gZW5jcnlwdCB0aGUgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkga21zS2V5PzogSUtleTtcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIFVuaXF1ZSB0byB0aGlzIGNsYXNzXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKipcbiAgICogVGhlIG1heCByYXRlIGF0IHdoaWNoIHBhZ2VzIGFyZSBjcmF3bGVkLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHNpdGVVcmxzOiBzdHJpbmdbXTtcbiAgLyoqXG4gICAqIFRoZSBtYXggcmF0ZSBhdCB3aGljaCBwYWdlcyBhcmUgY3Jhd2xlZC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBjcmF3bGluZ1JhdGU6IG51bWJlcjtcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEludGVybmFsIE9ubHlcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBUaGUgRGF0YSBTb3VyY2UgY2ZuIHJlc291cmNlLlxuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBfX3Jlc291cmNlOiBDZm5EYXRhU291cmNlO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBXZWJDcmF3bGVyRGF0YVNvdXJjZVByb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcbiAgICAvLyBBc3NpZ24gYXR0cmlidXRlc1xuICAgIHRoaXMua25vd2xlZGdlQmFzZSA9IHByb3BzLmtub3dsZWRnZUJhc2U7XG4gICAgdGhpcy5kYXRhU291cmNlVHlwZSA9IERhdGFTb3VyY2VUeXBlLldFQl9DUkFXTEVSO1xuICAgIHRoaXMuZGF0YVNvdXJjZU5hbWUgPVxuICAgICAgcHJvcHMuZGF0YVNvdXJjZU5hbWUgPz9cbiAgICAgIGdlbmVyYXRlUGh5c2ljYWxOYW1lVjIodGhpcywgJ2NyYXdsZXItZHMnLCB7IG1heExlbmd0aDogNDAsIGxvd2VyOiB0cnVlLCBzZXBhcmF0b3I6ICctJyB9KTtcbiAgICB0aGlzLmttc0tleSA9IHByb3BzLmttc0tleTtcbiAgICB0aGlzLmNyYXdsaW5nUmF0ZSA9IHByb3BzLmNyYXdsaW5nUmF0ZSA/PyAzMDA7XG4gICAgdGhpcy5zaXRlVXJscyA9IHByb3BzLnNvdXJjZVVybHM7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBNYW5hZ2UgcGVybWlzc2lvbnMgZm9yIHRoZSBkYXRhIHNvdXJjZVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMuaGFuZGxlQ29tbW9uUGVybWlzc2lvbnMocHJvcHMpO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTDEgSW5zdGFudGlhdGlvblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgdGhpcy5fX3Jlc291cmNlID0gbmV3IENmbkRhdGFTb3VyY2UodGhpcywgJ0RhdGFTb3VyY2UnLCB7XG4gICAgICAuLi50aGlzLmZvcm1hdEFzQ2ZuUHJvcHMocHJvcHMsIHtcbiAgICAgICAgdHlwZTogdGhpcy5kYXRhU291cmNlVHlwZSxcbiAgICAgICAgd2ViQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgIGNyYXdsZXJDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICBjcmF3bGVyTGltaXRzOiB7XG4gICAgICAgICAgICAgIHJhdGVMaW1pdDogdGhpcy5jcmF3bGluZ1JhdGUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2NvcGU6IHByb3BzLmNyYXdsaW5nU2NvcGUgIT09IENyYXdsaW5nU2NvcGUuREVGQVVMVCA/IHByb3BzLmNyYXdsaW5nU2NvcGUgOiB1bmRlZmluZWQsIC8vPz8gQ3Jhd2xpbmdTY29wZS5IT1NUX09OTFksXG4gICAgICAgICAgICBpbmNsdXNpb25GaWx0ZXJzOiBwcm9wcy5maWx0ZXJzPy5pbmNsdWRlUGF0dGVybnMsXG4gICAgICAgICAgICBleGNsdXNpb25GaWx0ZXJzOiBwcm9wcy5maWx0ZXJzPy5leGNsdWRlUGF0dGVybnMsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzb3VyY2VDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICB1cmxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgIHNlZWRVcmxzOiBwcm9wcy5zb3VyY2VVcmxzLm1hcChpdGVtID0+ICh7IHVybDogaXRlbSB9KSksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIHRoaXMuZGF0YVNvdXJjZUlkID0gdGhpcy5fX3Jlc291cmNlLmF0dHJEYXRhU291cmNlSWQ7XG4gIH1cbn1cbiJdfQ==